<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <title>Apache HBase Intoduction - ownport.github.io/notes</title>
    <meta name="google-site-verification" content="LmB1dDy5ueSqYPVOs6z4ylRQgNDxelgPYHsRLLtCG7c" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" />
    <!--<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css" rel="stylesheet" />-->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="http://ownport.github.io/notes/theme/style.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-65731833-1', 'auto');
      ga('send', 'pageview');

    </script>
  </head>
  <body id="index" class="archive">
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://ownport.github.io/notes">ownport.github.io/notes</a>
        </div>
        <div class="collapse navbar-collapse navbar-right">
          <ul class="nav navbar-nav">
            <li><a href="http://ownport.github.io/notes/pages/search.html">Search</a></li>
            <li><a href="http://ownport.github.io/notes/tags.html">tags</a></li>
          </ul>
        </div>
        <!-- /.navbar-collapse -->
      </div>
    </nav>
    <div class="container">
    <section id="content" class="article content">
      <header>
        <h2 class="entry-title">
          Apache HBase Intoduction
        </h2>
        
        <div class="text-muted">Thu 10 March 2016</div>
      </header>
<!-- .entry-content -->
      <div class="entry-content">
        <p>Original article: <a href="https://learnhbase.wordpress.com/">https://learnhbase.wordpress.com/</a></p>
<p>Use Apache HBase when you need random, realtime read/write access to your Big Data. This project’s goal is the hosting of very large tables — billions of rows X millions of columns — atop clusters of commodity hardware. Apache HBase is an open-source, distributed, versioned, column-oriented store modeled after Google’s Bigtable: A Distributed Storage System for Structured Data by Chang et al. Just as Bigtable leverages the distributed data storage provided by the Google File System, Apache HBase provides Bigtable-like capabilities on top of Hadoop and HDFS.
Features</p>
<ul>
<li>Linear and modular scalability.</li>
<li>Strictly consistent reads and writes.</li>
<li>Automatic and configurable sharding of tables</li>
<li>Automatic failover support between RegionServers.</li>
<li>Convenient base classes for backing Hadoop MapReduce jobs with Apache HBase tables.</li>
<li>Easy to use Java API for client access.</li>
<li>Block cache and Bloom Filters for real-time queries.</li>
<li>Query predicate push down via server side Filters</li>
<li>Thrift gateway and a REST-ful Web service that supports XML, Protobuf, and binary data encoding options</li>
<li>Extensible jruby-based (JIRB) shell</li>
<li>Support for exporting metrics via the Hadoop metrics subsystem to files or Ganglia; or via JM</li>
</ul>
<h3>HBase shell commands</h3>
<p>As told in HBase introduction, HBase provides Extensible jruby-based (JIRB) shell as a feature to execute some commands(each command represents one functionality).</p>
<p>HBase shell commands are mainly categorized into 6 parts</p>
<h3>General  HBase shell commands</h3>
<h4>status</h4>
<p>Show cluster status. Can be ‘summary’, ‘simple’, or ‘detailed’. The default is ‘summary’.</p>
<div class="highlight"><pre><span></span>hbase&gt; status
hbase&gt; status ‘simple’
hbase&gt; status ‘summary’
hbase&gt; status ‘detailed’
</pre></div>


<h4>version</h4>
<p>Output this HBase versionUsage:</p>
<div class="highlight"><pre><span></span>hbase&gt; version
</pre></div>


<h4>whoami</h4>
<p>Show the current hbase user.Usage:</p>
<div class="highlight"><pre><span></span>hbase&gt; whoami
</pre></div>


<h3>Tables Management commands</h3>
<h4>alter</h4>
<p>Alter column family schema; pass table name and a dictionary specifying new column family schema. Dictionaries are described on the main help command output. Dictionary must include name of column family to alter.For example, to change or add the ‘f1’ column family in table ‘t1’ from current value to keep a maximum of 5 cell VERSIONS, do:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, NAME =&gt; ‘f1’, VERSIONS =&gt; 5
</pre></div>


<p>You can operate on several column families:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, ‘f1’, {NAME =&gt; ‘f2’, IN_MEMORY =&gt; true}, {NAME =&gt; ‘f3’, VERSIONS =&gt; 5}
</pre></div>


<p>To delete the ‘f1’ column family in table ‘t1’, use one of:hbase&gt; alter ‘t1’, NAME =&gt; ‘f1’, METHOD =&gt; ‘delete’</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, ‘delete’ =&gt; ‘f1’
</pre></div>


<p>You can also change table-scope attributes like MAX_FILESIZE, READONLY, MEMSTORE_FLUSHSIZE, DEFERRED_LOG_FLUSH, etc. These can be put at the end; for example, to change the max size of a region to 128MB, do:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, MAX_FILESIZE =&gt; ‘134217728’
</pre></div>


<p>You can add a table coprocessor by setting a table coprocessor attribute:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, ‘coprocessor’=&gt;’hdfs:///foo.jar|com.foo.FooRegionObserver|1001|arg1=1,arg2=2’
</pre></div>


<p>Since you can have multiple coprocessors configured for a table, a sequence number will be automatically appended to the attribute name to uniquely identify it.</p>
<p>The coprocessor attribute must match the pattern below in order for the framework to understand how to load the coprocessor classes:</p>
<p>[coprocessor jar file location] | class name | [priority] | [arguments]</p>
<p>You can also set configuration settings specific to this table or column family:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, CONFIGURATION =&gt; {‘hbase.hregion.scan.loadColumnFamiliesOnDemand’ =&gt; ‘true’}
hbase&gt; alter ‘t1’, {NAME =&gt; ‘f2’, CONFIGURATION =&gt; {‘hbase.hstore.blockingStoreFiles’ =&gt; ’10’}}
</pre></div>


<p>You can also remove a table-scope attribute:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, METHOD =&gt; ‘table_att_unset’, NAME =&gt; ‘MAX_FILESIZE’
hbase&gt; alter ‘t1’, METHOD =&gt; ‘table_att_unset’, NAME =&gt; ‘coprocessor$1’
</pre></div>


<p>There could be more than one alteration in one command:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, { NAME =&gt; ‘f1’, VERSIONS =&gt; 3 }, { MAX_FILESIZE =&gt; ‘134217728’ }, { METHOD =&gt; ‘delete’, NAME =&gt; ‘f2’ }, OWNER =&gt; ‘johndoe’, METADATA =&gt; { ‘mykey’ =&gt; ‘myvalue’ }
</pre></div>


<h4>create</h4>
<p>Create table; pass table name, a dictionary of specifications per
column family, and optionally a dictionary of table configuration.</p>
<div class="highlight"><pre><span></span>hbase&gt; create ‘t1’, {NAME =&gt; ‘f1’, VERSIONS =&gt; 5}
hbase&gt; create ‘t1’, {NAME =&gt; ‘f1’}, {NAME =&gt; ‘f2’}, {NAME =&gt; ‘f3’}
hbase&gt; # The above in shorthand would be the following:
hbase&gt; create ‘t1’, ‘f1’, ‘f2’, ‘f3’
hbase&gt; create ‘t1’, {NAME =&gt; ‘f1’, VERSIONS =&gt; 1, TTL =&gt; 2592000, BLOCKCACHE =&gt; true}
hbase&gt; create ‘t1’, {NAME =&gt; ‘f1’, CONFIGURATION =&gt; {‘hbase.hstore.blockingStoreFiles’ =&gt; ’10’}}
</pre></div>


<p>Table configuration options can be put at the end.</p>
<h4>describe</h4>
<p>Describe the named table.</p>
<div class="highlight"><pre><span></span>hbase&gt; describe ‘t1’
</pre></div>


<h4>disable</h4>
<p>Start disable of named table</p>
<div class="highlight"><pre><span></span>hbase&gt; disable ‘t1’
</pre></div>


<h4>disable_all</h4>
<p>Disable all of tables matching the given regex</p>
<div class="highlight"><pre><span></span>hbase&gt; disable_all ‘t.*’
</pre></div>


<h4>is_disabled</h4>
<p>verifies Is named table disabled</p>
<div class="highlight"><pre><span></span>hbase&gt; is_disabled ‘t1’
</pre></div>


<h4>drop</h4>
<p>Drop the named table. Table must first be disabled</p>
<div class="highlight"><pre><span></span>hbase&gt; drop ‘t1’
</pre></div>


<h4>drop_all</h4>
<p>Drop all of the tables matching the given regex</p>
<div class="highlight"><pre><span></span>hbase&gt; drop_all ‘t.*’
</pre></div>


<h4>enable</h4>
<p>Start enable of named table</p>
<div class="highlight"><pre><span></span>hbase&gt; enable ‘t1’
</pre></div>


<h4>enable_all</h4>
<p>Enable all of the tables matching the given regex</p>
<div class="highlight"><pre><span></span>hbase&gt; enable_all ‘t.*’
</pre></div>


<h4>is_enabled</h4>
<p>verifies Is named table enabled</p>
<div class="highlight"><pre><span></span>hbase&gt; is_enabled ‘t1’
</pre></div>


<h4>exists</h4>
<p>Does the named table exist</p>
<div class="highlight"><pre><span></span>hbase&gt; exists ‘t1’
</pre></div>


<h4>list</h4>
<p>List all tables in hbase. Optional regular expression parameter could be used to filter the output</p>
<div class="highlight"><pre><span></span>hbase&gt; list
hbase&gt; list ‘abc.*’
</pre></div>


<h4>show_filters</h4>
<p>Show all the filters in hbase.</p>
<div class="highlight"><pre><span></span>hbase&gt; show_filters
</pre></div>


<h4>alter_status</h4>
<p>Get the status of the alter command. Indicates the number of regions of the table that have received the updated schema Pass table name.</p>
<div class="highlight"><pre><span></span>hbase&gt; alter_status ‘t1’
</pre></div>


<h4>alter_async</h4>
<p>Alter column family schema, does not wait for all regions to receive the schema changes. Pass table name and a dictionary specifying new column family schema. Dictionaries are described on the main help command output. Dictionary must include name of column family to alter.</p>
<p>To change or add the ‘f1’ column family in table ‘t1’ from defaults to instead keep a maximum of 5 cell VERSIONS, do:hbase&gt; alter_async ‘t1’, NAME =&gt; ‘f1’, VERSIONS =&gt; 5To delete the ‘f1’ column family in table ‘t1’, do:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter_async ‘t1’, NAME =&gt; ‘f1’, METHOD =&gt; ‘delete’or a shorter version:hbase&gt; alter_async ‘t1’, ‘delete’ =&gt; ‘f1’
</pre></div>


<p>You can also change table-scope attributes like MAX_FILESIZE, MEMSTORE_FLUSHSIZE, READONLY, and DEFERRED_LOG_FLUSH.</p>
<p>For example, to change the max size of a family to 128MB, do:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, METHOD =&gt; ‘table_att’, MAX_FILESIZE =&gt; ‘134217728’
</pre></div>


<p>There could be more than one alteration in one command:</p>
<div class="highlight"><pre><span></span>hbase&gt; alter ‘t1’, {NAME =&gt; ‘f1’}, {NAME =&gt; ‘f2’, METHOD =&gt; ‘delete’}
</pre></div>


<p>To check if all the regions have been updated, use alter_status <table_name></p>
<h3>Data Manipulation commands</h3>
<h4>count</h4>
<p>Count the number of rows in a table. Return value is the number of rows. This operation may take a LONG time (Run ‘$HADOOP_HOME/bin/hadoop jar hbase.jar rowcount’ to run a counting mapreduce job). Current count is shown every 1000 rows by default. Count interval may be optionally specified. Scan caching is enabled on count scans by default. Default cache size is 10 rows. If your rows are small in size, you may want to increase this  parameter. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; count ‘t1’
hbase&gt; count ‘t1’, INTERVAL =&gt; 100000
hbase&gt; count ‘t1’, CACHE =&gt; 1000
hbase&gt; count ‘t1’, INTERVAL =&gt; 10, CACHE =&gt; 1000
</pre></div>


<p>The same commands also can be run on a table reference. Suppose you had a reference t to table ‘t1’, the corresponding commands would be:</p>
<div class="highlight"><pre><span></span>hbase&gt; t.count
hbase&gt; t.count INTERVAL =&gt; 100000
hbase&gt; t.count CACHE =&gt; 1000
hbase&gt; t.count INTERVAL =&gt; 10, CACHE =&gt; 1000
</pre></div>


<h4>delete</h4>
<p>Put a delete cell value at specified table/row/column and optionally timestamp coordinates. Deletes must match the deleted cell’s coordinates exactly. When scanning, a delete cell suppresses older versions. To delete a cell from ‘t1’ at row ‘r1’ under column ‘c1’ marked with the time ‘ts1’, do:</p>
<div class="highlight"><pre><span></span>hbase&gt; delete ‘t1’, ‘r1’, ‘c1’, ts1
</pre></div>


<p>The same command can also be run on a table reference. Suppose you had a reference t to table ‘t1’, the corresponding command would be:hbase&gt; t.delete ‘r1’, ‘c1’, ts1</p>
<h4>deleteall</h4>
<p>Delete all cells in a given row; pass a table name, row, and optionally a column and timestamp. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; deleteall ‘t1’, ‘r1’
hbase&gt; deleteall ‘t1’, ‘r1’, ‘c1’
hbase&gt; deleteall ‘t1’, ‘r1’, ‘c1’, ts1
</pre></div>


<p>The same commands also can be run on a table reference. Suppose you had a reference t to table ‘t1’, the corresponding command would be:</p>
<div class="highlight"><pre><span></span>hbase&gt; t.deleteall ‘r1’
hbase&gt; t.deleteall ‘r1’, ‘c1’
hbase&gt; t.deleteall ‘r1’, ‘c1’, ts1
</pre></div>


<h4>get</h4>
<p>Get row or cell contents; pass table name, row, and optionally a dictionary of column(s), timestamp, timerange and versions. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; get ‘t1’, ‘r1’
hbase&gt; get ‘t1’, ‘r1’, {TIMERANGE =&gt; [ts1, ts2]}
hbase&gt; get ‘t1’, ‘r1’, {COLUMN =&gt; ‘c1’}
hbase&gt; get ‘t1’, ‘r1’, {COLUMN =&gt; [‘c1’, ‘c2’, ‘c3’]}
hbase&gt; get ‘t1’, ‘r1’, {COLUMN =&gt; ‘c1’, TIMESTAMP =&gt; ts1}
hbase&gt; get ‘t1’, ‘r1’, {COLUMN =&gt; ‘c1’, TIMERANGE =&gt; [ts1, ts2], VERSIONS =&gt; 4}
hbase&gt; get ‘t1’, ‘r1’, {COLUMN =&gt; ‘c1’, TIMESTAMP =&gt; ts1, VERSIONS =&gt; 4}
hbase&gt; get ‘t1’, ‘r1’, {FILTER =&gt; “ValueFilter(=, ‘binary:abc’)”}
hbase&gt; get ‘t1’, ‘r1’, ‘c1’
hbase&gt; get ‘t1’, ‘r1’, ‘c1’, ‘c2’
hbase&gt; get ‘t1’, ‘r1’, [‘c1’, ‘c2’]
</pre></div>


<p>Besides the default ‘toStringBinary’ format, ‘get’ also supports custom formatting by column. A user can define a FORMATTER by adding it to the column name in the get specification. The FORMATTER can be stipulated:</p>
<ul>
<li>either as a org.apache.hadoop.hbase.util.Bytes method name (e.g, toInt, toString) </li>
<li>or as a custom class followed by method name: e.g. ‘c(MyFormatterClass).format’.Example formatting cf:qualifier1 and cf:qualifier2 both as Integers:</li>
</ul>
<div class="highlight"><pre><span></span>hbase&gt; get ‘t1’, ‘r1’ {COLUMN =&gt; [‘cf:qualifier1:toInt’,‘cf:qualifier2:c(org.apache.hadoop.hbase.util.Bytes).toInt’] }
</pre></div>


<p>Note that you can specify a FORMATTER by column only (cf:qualifer). You cannot specify a FORMATTER for all columns of a column family.The same commands also can be run on a reference to a table (obtained via get_table or create_table). Suppose you had a reference t to table ‘t1’, the corresponding commands would be:</p>
<div class="highlight"><pre><span></span>hbase&gt; t.get ‘r1’
hbase&gt; t.get ‘r1’, {TIMERANGE =&gt; [ts1, ts2]}
hbase&gt; t.get ‘r1’, {COLUMN =&gt; ‘c1’}
hbase&gt; t.get ‘r1’, {COLUMN =&gt; [‘c1’, ‘c2’, ‘c3’]}
hbase&gt; t.get ‘r1’, {COLUMN =&gt; ‘c1’, TIMESTAMP =&gt; ts1}
hbase&gt; t.get ‘r1’, {COLUMN =&gt; ‘c1’, TIMERANGE =&gt; [ts1, ts2], VERSIONS =&gt; 4}
hbase&gt; t.get ‘r1’, {COLUMN =&gt; ‘c1’, TIMESTAMP =&gt; ts1, VERSIONS =&gt; 4}
hbase&gt; t.get ‘r1’, {FILTER =&gt; “ValueFilter(=, ‘binary:abc’)”}
hbase&gt; t.get ‘r1’, ‘c1’
hbase&gt; t.get ‘r1’, ‘c1’, ‘c2’
hbase&gt; t.get ‘r1’, [‘c1’, ‘c2’]
</pre></div>


<h4>get_counter</h4>
<p>Return a counter cell value at specified table/row/column coordinates. A cell cell should be managed with atomic increment function oh HBase
and the data should be binary encoded. Example:</p>
<div class="highlight"><pre><span></span>hbase&gt; get_counter ‘t1’, ‘r1’, ‘c1’
</pre></div>


<p>The same commands also can be run on a table reference. Suppose you had a reference t to table ‘t1’, the corresponding command would be:</p>
<div class="highlight"><pre><span></span>hbase&gt; t.get_counter ‘r1’, ‘c1’
</pre></div>


<h4>incr</h4>
<p>Increments a cell ‘value’ at specified table/row/column coordinates. To increment a cell value in table ‘t1’ at row ‘r1’ under column ‘c1’ by 1 (can be omitted) or 10 do:</p>
<div class="highlight"><pre><span></span>hbase&gt; incr ‘t1’, ‘r1’, ‘c1’
hbase&gt; incr ‘t1’, ‘r1’, ‘c1’, 1
hbase&gt; incr ‘t1’, ‘r1’, ‘c1’, 10
</pre></div>


<p>The same commands also can be run on a table reference. Suppose you had a reference t to table ‘t1’, the corresponding command would be:</p>
<div class="highlight"><pre><span></span>hbase&gt; t.incr ‘r1’, ‘c1’
hbase&gt; t.incr ‘r1’, ‘c1’, 1
hbase&gt; t.incr ‘r1’, ‘c1’, 10
</pre></div>


<h4>put</h4>
<p>Put a cell ‘value’ at specified table/row/column and optionally timestamp coordinates. To put a cell value into table ‘t1’ at row ‘r1’ under column ‘c1’ marked with the time ‘ts1’, do:</p>
<div class="highlight"><pre><span></span>hbase&gt; put ‘t1’, ‘r1’, ‘c1’, ‘value’, ts1
</pre></div>


<p>The same commands also can be run on a table reference. Suppose you had a reference t to table ‘t1’, the corresponding command would be:</p>
<div class="highlight"><pre><span></span>hbase&gt; t.put ‘r1’, ‘c1’, ‘value’, ts1
</pre></div>


<h4>scan</h4>
<p>Scan a table; pass table name and optionally a dictionary of scanner specifications. Scanner specifications may include one or more of: TIMERANGE, FILTER, LIMIT, STARTROW, STOPROW, TIMESTAMP, MAXLENGTH, or COLUMNS, CACHEIf no columns are specified, all columns will be scanned.</p>
<p>To scan all members of a column family, leave the qualifier empty as in ‘col_family:’.The filter can be specified in two ways:</p>
<ul>
<li>Using a filterString – more information on this is available in the Filter Language document attached to the HBASE-4176 JIRA</li>
<li>Using the entire package name of the filter.Some examples:</li>
</ul>
<div class="highlight"><pre><span></span>hbase&gt; scan ‘.META.’
hbase&gt; scan ‘.META.’, {COLUMNS =&gt; ‘info:regioninfo’}
hbase&gt; scan ‘t1’, {COLUMNS =&gt; [‘c1’, ‘c2’], LIMIT =&gt; 10, STARTROW =&gt; ‘xyz’}
hbase&gt; scan ‘t1’, {COLUMNS =&gt; ‘c1’, TIMERANGE =&gt; [1303668804, 1303668904]}
hbase&gt; scan ‘t1’, {FILTER =&gt; “(PrefixFilter (‘row2’) AND (QualifierFilter (&gt;=, ‘binary:xyz’))) AND (TimestampsFilter ( 123, 456))”}
hbase&gt; scan ‘t1’, {FILTER =&gt; org.apache.hadoop.hbase.filter.ColumnPaginationFilter.new(1, 0)}
</pre></div>


<p>For experts, there is an additional option — CACHE_BLOCKS — which switches block caching for the scanner on (true) or off (false). By default it is enabled. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; scan ‘t1’, {COLUMNS =&gt; [‘c1’, ‘c2’], CACHE_BLOCKS =&gt; false}
</pre></div>


<p>Also for experts, there is an advanced option — RAW — which instructs the scanner to return all cells (including delete markers and uncollected deleted cells). This option cannot be combined with requesting specific COLUMNS. Disabled by default. Example:</p>
<div class="highlight"><pre><span></span>hbase&gt; scan ‘t1’, {RAW =&gt; true, VERSIONS =&gt; 10}
</pre></div>


<p>Besides the default ‘toStringBinary’ format, ‘scan’ supports custom formatting by column. A user can define a FORMATTER by adding it to the column name in the scan specification. The FORMATTER can be stipulated:</p>
<ul>
<li>either as a org.apache.hadoop.hbase.util.Bytes method name (e.g, toInt, toString)</li>
<li>or as a custom class followed by method name: e.g. ‘c(MyFormatterClass).format’.</li>
</ul>
<p>Example formatting cf:qualifier1 and cf:qualifier2 both as Integers:</p>
<div class="highlight"><pre><span></span>hbase&gt; scan ‘t1’, {COLUMNS =&gt; [‘cf:qualifier1:toInt’,‘cf:qualifier2:c(org.apache.hadoop.hbase.util.Bytes).toInt’] }
</pre></div>


<p>Note that you can specify a FORMATTER by column only (cf:qualifer). You cannot specify a FORMATTER for all columns of a column family.</p>
<p>Scan can also be used directly from a table, by first getting a reference to a table, like such:</p>
<div class="highlight"><pre><span></span>hbase&gt; t = get_table ‘t’
hbase&gt; t.scan
</pre></div>


<p>Note in the above situation, you can still provide all the filtering, columns, options, etc as described above.</p>
<h4>truncate</h4>
<p>Disables, drops and recreates the specified table. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt;truncate ‘t1’
</pre></div>


<h3>HBase surgery tools</h3>
<h4>assign</h4>
<p>Assign a region. Use with caution. If region already assigned, this command will do a force reassign. For experts only. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; assign ‘REGION_NAME’
</pre></div>


<h4>balancer</h4>
<p>Trigger the cluster balancer. Returns true if balancer ran and was able to tell the region servers to unassign all the regions to balance (the re-assignment itself is async). Otherwise false (Will not run if regions in transition). Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; balancer
</pre></div>


<h4>balance_switch</h4>
<p>Enable/Disable balancer. Returns previous balancer state. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; balance_switch true
hbase&gt; balance_switch false
</pre></div>


<h4>close_region</h4>
<p>Close a single region. Ask the master to close a region out on the cluster or if ‘SERVER_NAME’ is supplied, ask the designated hosting regionserver to close the region directly. Closing a region, the master expects ‘REGIONNAME’ to be a fully qualified region name. When asking the hosting regionserver to directly close a region, you pass the regions’ encoded name only. A region name looks like this:TestTable,0094429456,1289497600452.527db22f95c8a9e0116f0cc13c680396. The trailing period is part of the regionserver name. A region’s encoded name is the hash at the end of a region name; e.g. 527db22f95c8a9e0116f0cc13c680396 (without the period). A ‘SERVER_NAME’ is its host, port plus startcode. For example: host187.example.com,60020,1289493121758 (find servername in master ui or when you do detailed status in shell). This command will end up running close on the region hosting regionserver. The close is done without the master’s involvement (It will not know of the close). Once closed, region will stay closed. Use assign to reopen/reassign. Use unassign or move to assign the region elsewhere on cluster. Use with caution. For experts only. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; close_region ‘REGIONNAME’
hbase&gt; close_region ‘REGIONNAME’, ‘SERVER_NAME’
</pre></div>


<h4>compact</h4>
<p>Compact all regions in passed table or pass a region row to compact an individual region. You can also compact a single column family within a region. Examples:</p>
<p>Compact all regions in a table:</p>
<div class="highlight"><pre><span></span>hbase&gt; compact ‘t1’
</pre></div>


<p>Compact an entire region:</p>
<div class="highlight"><pre><span></span>hbase&gt; compact ‘r1’
</pre></div>


<p>Compact only a column family within a region:</p>
<div class="highlight"><pre><span></span>hbase&gt; compact ‘r1’, ‘c1’
</pre></div>


<p>Compact a column family within a table:</p>
<div class="highlight"><pre><span></span>hbase&gt; compact ‘t1’, ‘c1’
</pre></div>


<h4>flush</h4>
<p>Flush all regions in passed table or pass a region row to flush an individual region. For example:</p>
<div class="highlight"><pre><span></span>hbase&gt; flush ‘TABLENAME’
hbase&gt; flush ‘REGIONNAME’
</pre></div>


<h4>major_compact</h4>
<p>Run major compaction on passed table or pass a region row to major compact an individual region. To compact a single
column family within a region specify the region name followed by the column family name. Examples:</p>
<p>Compact all regions in a table:</p>
<div class="highlight"><pre><span></span>hbase&gt; major_compact ‘t1’
</pre></div>


<p>Compact an entire region:</p>
<div class="highlight"><pre><span></span>hbase&gt; major_compact ‘r1’
</pre></div>


<p>Compact a single column family within a region:</p>
<div class="highlight"><pre><span></span>hbase&gt; major_compact ‘r1’, ‘c1’
</pre></div>


<p>Compact a single column family within a table:</p>
<div class="highlight"><pre><span></span>hbase&gt; major_compact ‘t1’, ‘c1’
</pre></div>


<h4>move</h4>
<p>Move a region. Optionally specify target regionserver else we choose one at random. NOTE: You pass the encoded region name, not the region name so this command is a little different to the others. The encoded region name is the hash suffix on region names: e.g. if the region name were TestTable,0094429456,1289497600452.527db22f95c8a9e0116f0cc13c680396. then the encoded region name portion is 527db22f95c8a9e0116f0cc13c680396 A server name is its host, port plus startcode. For example: host187.example.com,60020,1289493121758. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; move ‘ENCODED_REGIONNAME’
hbase&gt; move ‘ENCODED_REGIONNAME’, ‘SERVER_NAME’
</pre></div>


<h4>split</h4>
<p>Split entire table or pass a region to split individual region. With the second parameter, you can specify an explicit split key for the region. Examples:</p>
<div class="highlight"><pre><span></span>split ‘tableName’
split ‘regionName’ # format: ‘tableName,startKey,id’
split ‘tableName’, ‘splitKey’
split ‘regionName’, ‘splitKey’
</pre></div>


<h4>unassign</h4>
<p>Unassign a region. Unassign will close region in current location and then reopen it again. Pass ‘true’ to force the unassignment (‘force’ will clear all in-memory state in master before the reassign. If results in double assignment use hbck -fix to resolve. To be used by experts). Use with caution. For expert use only. Examples:hbase&gt; unassign ‘REGIONNAME’</p>
<div class="highlight"><pre><span></span>hbase&gt; unassign ‘REGIONNAME’, true
</pre></div>


<h4>hlog_roll</h4>
<p>Roll the log writer. That is, start writing log messages to a new file. The name of the regionserver should be given as the parameter. A ‘server_name’ is the host, port plus startcode of a regionserver. For example: host187.example.com,60020,1289493121758 (find servername in master ui or when you do detailed status in shell)</p>
<div class="highlight"><pre><span></span>hbase&gt; hlog_roll
</pre></div>


<h4>zk_dump</h4>
<p>Dump status of HBase cluster as seen by ZooKeeper. Example:</p>
<div class="highlight"><pre><span></span>hbase&gt; zk_dump
</pre></div>


<h3>Cluster replication tools</h3>
<h4>add_peer</h4>
<p>Add a peer cluster to replicate to, the id must be a short and the cluster key is composed like this: hbase.zookeeper.quorum:hbase.zookeeper.property.clientPort:zookeeper.znode.parent This gives a full path for HBase to connect to another cluster.
Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; add_peer ‘1’, “server1.cie.com:2181:/hbase”
hbase&gt; add_peer ‘2’, “zk1,zk2,zk3:2182:/hbase-prod”
</pre></div>


<h4>remove_peer</h4>
<p>Stops the specified replication stream and deletes all the meta information kept about it. Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; remove_peer ‘1’
</pre></div>


<h4>list_peers</h4>
<p>List all replication peer clusters.</p>
<div class="highlight"><pre><span></span>hbase&gt; list_peers
</pre></div>


<h4>enable_peer</h4>
<p>Restarts the replication to the specified peer cluster, continuing from where it was disabled.Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; enable_peer ‘1’
</pre></div>


<h4>disable_peer</h4>
<p>Stops the replication stream to the specified cluster, but still keeps track of new edits to replicate.Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; disable_peer ‘1’
</pre></div>


<h4>start_replication</h4>
<p>Restarts all the replication features. The state in which each stream starts in is undetermined.</p>
<p><em>WARNING</em>: start/stop replication is only meant to be used in critical load situations.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; start_replication
</pre></div>


<h4>stop_replication</h4>
<p>Stops all the replication features. The state in which each stream stops in is undetermined.</p>
<p><em>WARNING</em>: start/stop replication is only meant to be used in critical load situations.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span>hbase&gt; stop_replication
</pre></div>


<h3>Security tools</h3>
<h4>grant</h4>
<p>Grant users specific rights.</p>
<p>Syntax : grantpermissions is either zero or more letters from the set “RWXCA”. READ(‘R’), WRITE(‘W’), EXEC(‘X’), CREATE(‘C’), ADMIN(‘A’). For example:</p>
<div class="highlight"><pre><span></span>hbase&gt; grant ‘bobsmith’, ‘RWXCA’
hbase&gt; grant ‘bobsmith’, ‘RW’, ‘t1’, ‘f1’, ‘col1’
</pre></div>


<h4>revoke</h4>
<p>Revoke a user’s access rights. Syntax : revoke</p>
<p>For example:</p>
<div class="highlight"><pre><span></span>hbase&gt; revoke ‘bobsmith’, ‘t1’, ‘f1’, ‘col1’
</pre></div>


<h4>user_permission</h4>
<p>Show all permissions for the particular user.</p>
<p>Syntax : user_permission</p>
<p>For example:</p>
<div class="highlight"><pre><span></span>hbase&gt; user_permission
hbase&gt; user_permission ‘table1’
</pre></div>
      </div>
<!-- /.entry-content -->
      <footer class="post-info text-muted">
        <button type="button" class="btn btn-default">          
          <a href="http://ownport.github.io/notes/category/2016.html"><div class="fa fa-lg fa-folder-open"></div> 2016</a>
        </button>
        <button type="button" class="btn btn-default">
          <a href="http://ownport.github.io/notes/tag/hadoop.html"><div class="fa fa-lg fa-tag"></div> hadoop</a>
        </button>
        <button type="button" class="btn btn-default">
          <a href="http://ownport.github.io/notes/tag/bigdata.html"><div class="fa fa-lg fa-tag"></div> bigdata</a>
        </button>
        <button type="button" class="btn btn-default">
          <a href="http://ownport.github.io/notes/tag/hbase.html"><div class="fa fa-lg fa-tag"></div> hbase</a>
        </button>
        <button type="button" class="btn btn-default">
          <a href="http://ownport.github.io/notes/tag/commands.html"><div class="fa fa-lg fa-tag"></div> commands</a>
        </button>
      </footer>
      <!-- /.post-info -->
    </section>
    </div>
    <footer class="footer">
      <div class="container">
        <p class="footer-text">&copy; <a href="http://ownport.github.io/notes">ownport.github.io/notes</a> powered by <a href="http://getpelican.com/">pelican</a> and <a href="http://nodotcom.org">nikhil (customized)</a></p>
      </div>
    </footer>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>